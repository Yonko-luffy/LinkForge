{% extends "base.html" %}

{% block title %}LinkForge - URL Shortener & QR Generator{% endblock %}

{% block content %}
<div class="hero">
    <h1>🔗 LinkForge</h1>
    <p>Create short links and QR codes instantly. Professional URL management made simple.</p>
</div>

<div class="tool-selector">
    <button class="tool-tab active" onclick="switchTool('shorten')">🔗 Shorten URL</button>
    <button class="tool-tab" onclick="switchTool('qr')">📱 Generate QR Code</button>
</div>

<!-- URL Shortener Section -->
<div id="shorten-section" class="tool-section">
    <div class="form">
        <h2>🔗 Shorten URL</h2>
        <form method="POST" action="{{ url_for('shorten_url') }}">
            <div class="form-group">
                <label for="url" class="form-label">Enter URL to shorten:</label>
                <input type="url" id="url" name="url" class="form-input" placeholder="https://example.com" required>
            </div>
            <div class="form-group">
                <label for="name" class="form-label">Custom name (optional):</label>
                <input type="text" id="name" name="name" class="form-input" placeholder="My awesome link">
            </div>
            <button type="submit" class="btn btn-primary btn-large">🔗 Shorten URL</button>
        </form>
    </div>

    {% if session.last_shortened %}
    <div class="card fade-in">
        <div class="card-header">
            <h3 class="card-title">✅ URL Shortened Successfully!</h3>
        </div>
        <div class="card-body">
            <p><strong>Original URL:</strong><br>
            <span class="url-original">{{ session.last_shortened.original_url }}</span></p>

            <p><strong>Short URL:</strong><br>
            <a href="{{ session.last_shortened.short_url }}" target="_blank" class="url-short">{{ session.last_shortened.short_url }}</a></p>

            {% if session.last_shortened.qr_code %}
            <div class="qr-container">
                <img src="{{ session.last_shortened.qr_code }}" alt="QR Code" class="qr-code">
            </div>
            {% endif %}
        </div>
        <div class="card-footer">
            <button onclick="copyToClipboard('{{ session.last_shortened.short_url }}')" class="btn btn-secondary">📋 Copy Link</button>
            {% if session.last_shortened.qr_code %}
            <button onclick="downloadQR('{{ session.last_shortened.qr_code }}')" class="btn btn-secondary">⬇️ Download QR</button>
            {% endif %}
            {% if not session.user_id %}
            <a href="{{ url_for('register') }}" class="btn btn-primary">💾 Sign up to save links</a>
            {% endif %}
        </div>
    </div>
    {{ session.pop('last_shortened', None) or '' }}
    {% endif %}
</div>

<!-- QR Code Generator Section -->
<div id="qr-section" class="tool-section hidden">
    <div class="form">
        <h2>📱 Generate QR Code</h2>
        <form method="POST" action="{{ url_for('generate_qr') }}">
            <div class="form-group">
                <label for="qr-url" class="form-label">Enter URL for QR code:</label>
                <input type="url" id="qr-url" name="url" class="form-input" placeholder="https://example.com" required>
            </div>
            <button type="submit" class="btn btn-primary btn-large">📱 Generate QR Code</button>
        </form>
    </div>

    {% if session.last_qr %}
    <div class="card fade-in">
        <div class="card-header">
            <h3 class="card-title">✅ QR Code Generated Successfully!</h3>
        </div>
        <div class="card-body">
            <p><strong>URL:</strong><br>
            <span class="url-original">{{ session.last_qr.url }}</span></p>

            <div class="qr-container">
                <img src="{{ session.last_qr.qr_code }}" alt="QR Code" class="qr-code">
            </div>
        </div>
        <div class="card-footer">
            <button onclick="copyToClipboard('{{ session.last_qr.url }}')" class="btn btn-secondary">📋 Copy URL</button>
            <button onclick="downloadQR('{{ session.last_qr.qr_code }}')" class="btn btn-secondary">⬇️ Download QR</button>
            {% if not session.user_id %}
            <a href="{{ url_for('register') }}" class="btn btn-primary">💾 Sign up to save QR codes</a>
            {% endif %}
        </div>
    </div>
    {{ session.pop('last_qr', None) or '' }}
    {% endif %}
</div>

{% if not session.user_id %}
<div class="card">
    <div class="card-header">
        <h3 class="card-title">🚀 Why Create an Account?</h3>
    </div>
    <div class="card-body">
        <div class="grid grid-2">
            <div>
                <h4>📊 Track Performance</h4>
                <p>Monitor clicks and engagement on all your links</p>
            </div>
            <div>
                <h4>🔧 Manage Links</h4>
                <p>Edit, organize, and delete your shortened URLs</p>
            </div>
            <div>
                <h4>⭐ Favorites</h4>
                <p>Mark important links as favorites for quick access</p>
            </div>
            <div>
                <h4>📱 QR Codes</h4>
                <p>Generate and download QR codes for all your links</p>
            </div>
        </div>
    </div>
    <div class="card-footer">
        <a href="{{ url_for('register') }}" class="btn btn-primary">🆓 Sign Up Free</a>
        <a href="{{ url_for('login') }}" class="btn btn-secondary">🔑 Login</a>
    </div>
</div>
{% endif %}
{% endblock %}